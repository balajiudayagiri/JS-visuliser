<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JavaScript Execution Visualizer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .execution-block {
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .execution-block.active {
        background-color: #eff6ff;
        transform: scale(1.02);
        box-shadow: 0 6px 8px rgba(59, 130, 246, 0.2);
      }
      .execution-block.executing {
        animation: pulse 1.5s infinite;
      }
      .variable-box {
        transition: all 0.2s ease;
      }
      .variable-box.changed {
        background-color: #fef3c7;
        animation: highlight 1s;
      }
      @keyframes pulse {
        0% {
          box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4);
        }
        70% {
          box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
        }
      }
      @keyframes highlight {
        0% {
          background-color: #fef3c7;
        }
        100% {
          background-color: #f9fafb;
        }
      }
      .stack-animation {
        transition: all 0.5s ease;
      }
      .console-message {
        font-family: monospace;
        white-space: pre;
      }
    </style>
  </head>
  <body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
      <header class="mb-12">
        <h1 class="text-4xl font-bold text-center text-blue-700 mb-4">
          JavaScript Execution Visualizer
        </h1>
        <p class="text-lg text-center text-gray-600 max-w-3xl mx-auto">
          Step-by-step visualization of how JavaScript executes code in the
          engine, showing the call stack, memory allocation, scope chain, and
          execution context.
        </p>
      </header>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8">
        <!-- Code Editor -->
        <div class="lg:col-span-2 bg-white rounded-xl shadow-md p-6">
          <h2 class="text-2xl font-semibold text-gray-800 mb-4">
            Code Execution
          </h2>
          <div class="mb-6">
            <textarea
              id="codeInput"
              class="w-full h-64 p-4 border border-gray-300 rounded-lg font-mono text-sm">
function outer() {
    let outerVar = 'Outer variable';
    
    function inner() {
        let innerVar = 'Inner variable';
        console.log(`${outerVar} - ${innerVar}`);
    }
    
    return inner;
}

const demoFunc = outer();
demoFunc();</textarea
            >
          </div>
          <div class="flex justify-between">
            <button
              id="stepBtn"
              class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg">
              Step Through
            </button>
            <button
              id="runBtn"
              class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg">
              Run All
            </button>
            <button
              id="resetBtn"
              class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-2 rounded-lg">
              Reset
            </button>
          </div>
        </div>

        <!-- Execution Context Diagram -->
        <div class="bg-white rounded-xl shadow-md p-6">
          <h2 class="text-2xl font-semibold text-gray-800 mb-4">
            Execution Context
          </h2>
          <div class="space-y-4">
            <img
              src="https://placehold.co/600x400"
              alt="Diagram showing JavaScript execution context with global, outer, and inner contexts stacked vertically" />
            <div class="bg-gray-100 p-4 rounded-lg text-sm">
              <p>
                <span class="font-semibold">Global Context:</span> Base
                execution context (this === window)
              </p>
              <p>
                <span class="font-semibold">Function Context:</span> Created per
                function call
              </p>
              <p>
                <span class="font-semibold">Scope Chain:</span> Links nested
                execution contexts
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Visualization Sections -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Call Stack -->
        <div class="bg-white rounded-xl shadow-md p-6">
          <h2 class="text-2xl font-semibold text-gray-800 mb-4">Call Stack</h2>
          <div
            id="callStack"
            class="border border-gray-200 rounded-lg p-4 min-h-48 space-y-2">
            <div class="text-center text-gray-500 py-4">
              Call stack will appear here...
            </div>
          </div>
          <div class="mt-4 bg-blue-50 p-4 rounded-lg text-sm">
            <p>
              The call stack is a LIFO (Last-In-First-Out) structure that tracks
              function execution order.
            </p>
            <p class="mt-2">
              When a function is called, it's pushed onto the stack, and when it
              returns, it's popped off.
            </p>
          </div>
        </div>

        <!-- Scope Chain and Variables -->
        <div class="bg-white rounded-xl shadow-md p-6">
          <h2 class="text-2xl font-semibold text-gray-800 mb-4">
            Scope Chain & Variables
          </h2>
          <div id="scopeChain" class="space-y-4">
            <div
              class="border border-gray-200 rounded-lg p-4 space-y-2 execution-block">
              <h3 class="font-semibold text-gray-700">Global Scope</h3>
              <div id="globalVariables" class="space-y-2">
                <div
                  class="variable-box px-3 py-1 bg-gray-100 rounded text-sm font-mono">
                  demoFunc: undefined
                </div>
              </div>
            </div>
            <div
              class="border border-gray-200 rounded-lg p-4 space-y-2 execution-block">
              <h3 class="font-semibold text-gray-700">Lexical Scope</h3>
              <div
                id="lexicalVariables"
                class="space-y-2 text-sm text-gray-500">
                (Will be populated during execution)
              </div>
            </div>
          </div>
          <div class="mt-4 bg-green-50 p-4 rounded-lg text-sm">
            <p>
              JavaScript uses lexical scoping - variables are accessible within
              their own scope and all nested scopes.
            </p>
            <p class="mt-2">
              Closures maintain references to outer variables even after outer
              functions return.
            </p>
          </div>
        </div>

        <!-- Heap & Memory -->
        <div class="bg-white rounded-xl shadow-md p-6">
          <h2 class="text-2xl font-semibold text-gray-800 mb-4">Memory Heap</h2>
          <div
            id="memoryHeap"
            class="border border-gray-200 rounded-lg p-4 min-h-48 flex flex-wrap gap-3">
            <div class="text-center text-gray-500 py-4 w-full">
              Heap allocations will appear here...
            </div>
          </div>
          <div class="mt-4 bg-purple-50 p-4 rounded-lg text-sm">
            <p>
              The heap is where objects, functions, and complex data types are
              stored.
            </p>
            <p class="mt-2">
              Primitives are stored in the execution context, while reference
              types live in the heap.
            </p>
          </div>
        </div>
      </div>

      <!-- Console Output -->
      <div class="mt-8 bg-gray-800 rounded-xl shadow-md p-6">
        <h2 class="text-xl font-semibold text-white mb-4">Console Output</h2>
        <pre
          id="consoleOutput"
          class="bg-black text-green-400 p-4 rounded-lg max-h-48 overflow-y-auto"></pre>
      </div>

      <!-- Explanations -->
      <div class="mt-12 bg-white rounded-xl shadow-md p-8">
        <h2 class="text-3xl font-bold text-center text-blue-700 mb-6">
          How JavaScript Execution Works
        </h2>

        <div class="space-y-6">
          <div class="flex flex-col md:flex-row gap-6">
            <div class="md:w-1/2">
              <h3 class="text-xl font-semibold text-gray-800 mb-3">
                Execution Context
              </h3>
              <p class="text-gray-600">
                JavaScript runs code in execution contexts. Each function call
                creates a new execution context with:
              </p>
              <ul class="list-disc pl-5 mt-2 space-y-1 text-gray-600">
                <li>A variable environment (let, const, var)</li>
                <li>A scope chain (reference to outer environments)</li>
                <li>A 'this' binding</li>
              </ul>
            </div>
            <div class="md:w-1/2">
              <img
                src="https://placehold.co/600x300"
                alt="Visual representation of JavaScript execution contexts showing global context encompassing multiple function contexts" />
            </div>
          </div>

          <div class="flex flex-col md:flex-row gap-6">
            <div class="md:w-1/2">
              <img
                src="https://placehold.co/600x300"
                alt="Diagram showing JavaScript event loop with callback queue and microtask queue feeding into the call stack" />
            </div>
            <div class="md:w-1/2">
              <h3 class="text-xl font-semibold text-gray-800 mb-3">
                Memory Management
              </h3>
              <p class="text-gray-600">
                JavaScript handles memory automatically through a garbage
                collector:
              </p>
              <ul class="list-disc pl-5 mt-2 space-y-1 text-gray-600">
                <li>
                  Primitives (numbers, strings, booleans) are stored directly in
                  the execution context
                </li>
                <li>
                  Objects, arrays, and functions are stored in the memory heap
                </li>
                <li>Variables hold references to objects in the heap</li>
              </ul>
            </div>
          </div>

          <div class="flex flex-col md:flex-row gap-6">
            <div class="md:w-1/2">
              <h3 class="text-xl font-semibold text-gray-800 mb-3">
                Hoisting Behavior
              </h3>
              <p class="text-gray-600">
                JavaScript processes declarations before execution:
              </p>
              <ul class="list-disc pl-5 mt-2 space-y-1 text-gray-600">
                <li>
                  Variable declarations (var) are hoisted with default
                  <code>undefined</code>
                </li>
                <li>
                  Function declarations are hoisted with their definitions
                </li>
                <li>
                  <code>let</code> and <code>const</code> are in Temporal Dead
                  Zone until declaration
                </li>
              </ul>
            </div>
            <div class="md:w-1/2">
              <img
                src="https://placehold.co/600x300"
                alt="Illustration showing JavaScript hoisting where variable declarations float to the top of their scope" />
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="./visualizer.js"></script>
  </body>
</html>
